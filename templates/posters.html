{% extends "base.html" %}

{% block title %}Movie Posters Collection - Filmytea{% endblock %}

{% block description %}Browse our premium collection of movie posters and entertainment art. High-quality prints available in A4 and A3 sizes with framing options.{% endblock %}

{% block keywords %}movie posters, film prints, entertainment art, poster collection, movie art, cinema posters{% endblock %}

{% block main_class %}posters-main{% endblock %}

{% block content %}
<div class="container">
    <section class="posters-hero">
        <h2>Movie Poster Collection</h2>
        <p>{{ posters|length }} premium posters available</p>
    </section>

    <section class="posters" aria-label="Poster collection">
        <div class="posters-grid" role="grid">
            {% for poster in posters %}
            <article class="poster-card" role="gridcell">
                <a href="{{ url_for('poster_detail', poster_id=poster.id) }}" class="poster-link" aria-label="View {{ poster.name }} poster details">
                    <div class="poster-image">
                        <img {% if loop.index <= 4 %}src{% else %}data-src{% endif %}="{{ poster.image_url.replace('/upload/', '/upload/w_400,h_600,c_fill,f_auto,q_auto/') }}" 
                             alt="{{ poster.name }} movie poster" 
                             loading="{% if loop.index <= 4 %}eager{% else %}lazy{% endif %}"
                             decoding="async"
                             width="400" 
                             height="600">
                    </div>
                    <div class="poster-info">
                        <h3>{{ poster.name }}</h3>
                    </div>
                </a>
            </article>
            {% endfor %}
        </div>
    </section>
</div>
{% endblock %}

{% block scripts %}
<script>
        // Ultra-fast image loading optimization
        document.addEventListener('DOMContentLoaded', function() {
            const images = document.querySelectorAll('.poster-image img');
            
            images.forEach((img, index) => {
                img.addEventListener('load', function() {
                    this.setAttribute('data-loaded', 'true');
                });
                
                img.addEventListener('error', function() {
                    this.style.opacity = '0.3';
                    this.alt = 'Image unavailable';
                });
            });
            
            // Efficient scroll-based preloading
            let ticking = false;
            function updateImages() {
                const lazyImages = document.querySelectorAll('img[data-src]:not([src])');
                const windowHeight = window.innerHeight;
                const scrollTop = window.pageYOffset;
                
                lazyImages.forEach(img => {
                    const rect = img.getBoundingClientRect();
                    if (rect.top < windowHeight + 200) { // 200px buffer
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                    }
                });
                ticking = false;
            }
            
            window.addEventListener('scroll', function() {
                if (!ticking) {
                    requestAnimationFrame(updateImages);
                    ticking = true;
                }
            });
            
            // Initial load
            updateImages();
        });
        
        // Grid items no longer have add to cart functionality - removed
</script>
{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Movie Poster Collection",
    "description": "Browse our premium collection of movie posters",
    "url": "{{ request.url }}",
    "mainEntity": {
        "@type": "ItemList",
        "numberOfItems": {{ posters|length }},
        "itemListElement": [
            {% for poster in posters %}
            {
                "@type": "Product",
                "name": "{{ poster.name }}",
                "image": "{{ poster.image_url }}",
                "url": "{{ url_for('poster_detail', poster_id=poster.id, _external=True) }}"
            }{% if not loop.last %},{% endif %}
            {% endfor %}
        ]
    }
}
</script>
{% endblock %}