{% extends "base.html" %}

{% block title %}Movie Posters Collection - Filmytea{% endblock %}

{% block description %}Browse our premium collection of movie posters and entertainment art. High-quality prints available in A4 and A3 sizes with framing options.{% endblock %}

{% block keywords %}movie posters, film prints, entertainment art, poster collection, movie art, cinema posters{% endblock %}

{% block main_class %}posters-main{% endblock %}

{% block content %}
<div class="container">
    <section class="posters-hero">
        <h2>Movie Poster Collection</h2>
        <p>{{ posters|length }} premium posters available</p>
    </section>

    <section class="posters" aria-label="Poster collection">
        <div class="posters-grid" role="grid">
            {% for poster in posters %}
            <article class="poster-card" role="gridcell">
                <a href="{{ url_for('poster_detail', poster_id=poster.id) }}" class="poster-link" aria-label="View {{ poster.name }} poster details">
                    <div class="poster-image">
                        <img src="{{ poster.image_url.replace('/upload/', '/upload/w_400,h_600,c_fill,f_auto,q_auto/') }}" 
                             alt="{{ poster.name }} movie poster" 
                             loading="{% if loop.index <= 6 %}eager{% else %}lazy{% endif %}"
                             decoding="async"
                             width="400" 
                             height="600">
                    </div>
                    <div class="poster-info">
                        <h3>{{ poster.name }}</h3>
                    </div>
                </a>
            </article>
            {% endfor %}
        </div>
    </section>
</div>
{% endblock %}

{% block scripts %}
<script>
        // Optimize image loading
        document.addEventListener('DOMContentLoaded', function() {
            const images = document.querySelectorAll('.poster-image img');
            
            images.forEach((img, index) => {
                img.addEventListener('load', function() {
                    this.style.opacity = '1';
                    this.parentElement.style.setProperty('--loaded', '1');
                });
                
                img.addEventListener('error', function() {
                    this.style.opacity = '0.5';
                    this.alt = 'Image failed to load';
                });
            });
            
            // Preload next batch of images when scrolling near bottom
            let preloadTriggered = false;
            window.addEventListener('scroll', function() {
                if (!preloadTriggered && (window.innerHeight + window.scrollY) >= document.body.offsetHeight - 1000) {
                    preloadTriggered = true;
                    // Preload remaining lazy images
                    const lazyImages = document.querySelectorAll('img[loading="lazy"]');
                    lazyImages.forEach(img => {
                        img.loading = 'eager';
                    });
                }
            });
        });
        
        // Grid items no longer have add to cart functionality - removed
</script>
{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Movie Poster Collection",
    "description": "Browse our premium collection of movie posters",
    "url": "{{ request.url }}",
    "mainEntity": {
        "@type": "ItemList",
        "numberOfItems": {{ posters|length }},
        "itemListElement": [
            {% for poster in posters %}
            {
                "@type": "Product",
                "name": "{{ poster.name }}",
                "image": "{{ poster.image_url }}",
                "url": "{{ url_for('poster_detail', poster_id=poster.id, _external=True) }}"
            }{% if not loop.last %},{% endif %}
            {% endfor %}
        ]
    }
}
</script>
{% endblock %}