{% extends "base.html" %}

{% block title %}{{ poster.name }} Poster - Filmytea{% endblock %}

{% block description %}{{ poster.name }} movie poster. High-quality print available in A4 and A3 sizes with custom framing options. Order now for fast delivery.{% endblock %}

{% block keywords %}{{ poster.name }}, movie poster, film print, {{ poster.name }} art, poster print{% endblock %}

{% block og_title %}{{ poster.name }} Movie Poster - Filmytea{% endblock %}
{% block og_description %}Premium {{ poster.name }} poster available in multiple sizes with framing options.{% endblock %}
{% block og_image %}{{ poster.image_url }}{% endblock %}

{% block preload %}
<link rel="preload" href="{{ poster.image_url.replace('/upload/', '/upload/w_600,h_800,c_fill,f_auto,q_auto/') }}" as="image">
{% endblock %}

{% block main_class %}poster-detail-main{% endblock %}

{% block content %}
<div class="page">
    <!-- Poster Image -->
    <div class="poster-image-container">
        <img src="{{ poster.image_url.replace('/upload/', '/upload/w_320,h_430,c_fill,f_auto,q_auto/') }}" 
             alt="{{ poster.name }}" 
             class="poster-image-main">
    </div>
    
    <!-- Poster Title -->
    <div class="poster-title">{{ poster.name }}</div>
    
    <!-- Price -->
    <div class="price" id="currentPrice">₹ 129.00</div>
    
    <!-- Size Section -->
    <div class="size-label">Size:</div>
    <div class="size-buttons">
        <button class="size-btn" data-size="A4">A4</button>
        <button class="size-btn active" data-size="A3">A3</button>
    </div>
    
    <!-- Frame Section -->
    <div class="frame-label">Frame:</div>
    <div class="frame-buttons">
        <button class="frame-btn active" data-frame="no" data-label="No frame">No frame</button>
        <button class="frame-btn" data-frame="black" data-label="Black frame">Black frame</button>
        <button class="frame-btn" data-frame="white" data-label="White frame">White frame</button>
    </div>
    
    <!-- Action Buttons -->
    <button class="add-to-cart-btn" id="addToCartBtn">Add to cart</button>
    <button class="buy-now-btn" id="buyNowBtn">Buy now</button>
    
    <!-- Poster Details Section -->
    <div class="details-title">Poster Details</div>
    
    <div class="details-section">
        <div class="detail-category">Sizes:</div>
        <div class="detail-item">A4 → 8.3 x 11.7 in</div>
        <div class="detail-item">A3 → 11.7 x 16.5 in</div>
        
        <div class="detail-category">Paper:</div>
        <div class="detail-item">300 GSM premium art board</div>
        <div class="detail-item">Thick, durable & long-lasting</div>
        
        <div class="detail-category">Frame Choices:</div>
        <div class="detail-item">No Frame (poster only)</div>
        <div class="detail-item">Black/White Frame (fiberwood, matte, 0.75 in)</div>
        
        <div class="detail-category">Dimensions with Frame:</div>
        <div class="detail-item">A4 → ~9.8 x 13.2 in</div>
        <div class="detail-item">A3 → ~13.2 x 18 in</div>
        
        <div class="detail-category">Finish:</div>
        <div class="detail-item">Smooth matte look</div>
        <div class="detail-item">Sharp & vibrant colors</div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
        const pricing = {
            'A4': { 'no': 129, 'black': 399, 'white': 399 },
            'A3': { 'no': 159, 'black': 499, 'white': 499 }
        };
        
        let selectedSize = 'A3';
        let selectedFrame = 'no';
        
        function updatePrice() {
            const price = pricing[selectedSize][selectedFrame];
            const priceElement = document.getElementById('currentPrice');
            if (priceElement) {
                priceElement.textContent = '₹ ' + price + '.00';
            }
        }
        
        // Handle size toggle
        document.querySelectorAll('[data-size]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-size]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedSize = this.dataset.size;
                updatePrice();
            });
        });
        
        // Handle frame toggle
        document.querySelectorAll('[data-frame]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-frame]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedFrame = this.dataset.frame;
                updatePrice();
            });
        });
        
        // Initialize default selection
        updatePrice();
        
        // Add to Cart functionality
        const addToCartBtn = document.getElementById('addToCartBtn');
        if (addToCartBtn) {
            addToCartBtn.addEventListener('click', function() {
                const poster = {
                    id: '{{ poster.id }}',
                    name: '{{ poster.name }}',
                    image_url: '{{ poster.image_url }}'
                };
                
                if (typeof cart !== 'undefined') {
                    cart.addItem(poster, selectedSize, selectedFrame);
                }
                
                // Visual feedback
                this.textContent = 'Added!';
                setTimeout(() => {
                    this.textContent = 'Add to cart';
                }, 1500);
            });
        }
        
        // Buy Now functionality
        const buyNowBtn = document.getElementById('buyNowBtn');
        if (buyNowBtn) {
            buyNowBtn.addEventListener('click', function() {
                const poster = {
                    id: '{{ poster.id }}',
                    name: '{{ poster.name }}',
                    image_url: '{{ poster.image_url }}'
                };
                
                if (typeof cart !== 'undefined') {
                    cart.addItem(poster, selectedSize, selectedFrame);
                }
                
                // Redirect to checkout page
                window.location.href = '{{ url_for("checkout") }}';
            });
        }
        
        // Image loading optimization
        const posterImg = document.querySelector('.poster-image-main');
        if (posterImg) {
            posterImg.addEventListener('load', function() {
                this.style.opacity = '1';
            });
            
            posterImg.addEventListener('error', function() {
                this.style.opacity = '0.5';
                this.alt = 'Image failed to load';
            });
        }
</script>
{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Product",
    "name": "{{ poster.name }}",
    "image": "{{ poster.image_url }}",
    "description": "{{ poster.name }} movie poster available in A4 and A3 sizes",
    "brand": {
        "@type": "Brand",
        "name": "Filmytea"
    },
    "offers": {
        "@type": "AggregateOffer",
        "lowPrice": "129",
        "highPrice": "499",
        "priceCurrency": "INR",
        "availability": "https://schema.org/InStock"
    }
}
</script>
{% endblock %}